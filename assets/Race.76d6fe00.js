import"./el-tooltip.a3af5ee2.js";import{E as G}from"./el-image-viewer.f2d7d23f.js";import{E as J,l as X,m as Z,M as ee,a as ae,b as le}from"./MyPagination.c59298a6.js";import"./el-table-column.5d709dc1.js";import{_ as N,E as te}from"./MyDialog.383463e7.js";import{d as oe,u as ue,r as n,e as S,K as re,l as ne,o as f,c as T,m as r,q as t,n as s,s as x,x as se,f as W,bY as ie,$ as ce,U as pe,bc as de,a as D,t as A,y as d}from"./index.41b9361d.js";import"./index.0da6d2ae.js";/* empty css                */const me=[{property:"round",slotName:"round",label:"\u573A\u6B21\u7F16\u53F7",showOverflowTooltip:!0,width:"120"},{column:"\u9009\u624B1",records:[{property:"player1Name",slotName:"player1Name",label:"\u6635\u79F0",minWidth:"120"},{property:"player1Image",slotName:"player1Image",label:"\u5934\u50CF",minWidth:"120"},{property:"player1Vote",slotName:"player1Vote",label:"\u5F97\u7968\u6570",minWidth:"100"},{property:"player1Score",slotName:"player1Score",label:"\u8BC4\u5206",minWidth:"120"},{property:"player1TotalScore",slotName:"player1TotalScore",label:"\u603B\u5206",minWidth:"120"}]},{column:"\u9009\u624B2",records:[{property:"player2Name",slotName:"player2Name",label:"\u6635\u79F0",minWidth:"120"},{property:"player2Image",slotName:"player2Image",label:"\u5934\u50CF",minWidth:"120"},{property:"player2Vote",slotName:"player2Vote",label:"\u5F97\u7968\u6570",minWidth:"100"},{property:"player2Score",slotName:"player2Score",label:"\u8BC4\u5206",minWidth:"120"},{property:"player2TotalScore",slotName:"player2TotalScore",label:"\u603B\u5206",minWidth:"120"}]},{property:"status",slotName:"status",label:"\u6BD4\u8D5B\u72B6\u6001",minWidth:"120",placeholder:"\u6BD4\u8D5B\u72B6\u6001",options:[{label:"\u5DF2\u7ED3\u675F",value:"0"},{label:"\u672A\u5F00\u59CB",value:"1"},{label:"\u8FDB\u884C\u4E2D",value:"2"}]},{slotName:"operation",label:"\u64CD\u4F5C",minWidth:"180"}],ge=[{type:"NUMBER_SELECT",label:"\u8F6E\u6B21",labelWidth:"60px",field:"roll",placeholder:"\u8BF7\u9009\u62E9\u8F6E\u6B21",total:{1:!1}}],he={title:"\u89C2\u4F17\u6279\u91CF\u6DFB\u52A0",confirmText:"\u6279\u91CF\u6DFB\u52A0",items:[{type:"INPUT",label:"\u7528\u6237\u6570\u91CF",labelWidth:"80px",placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u6570\u91CF",field:"number"}]},ye={title:"\u6DFB\u52A0\u7528\u6237",confirmText:"\u6DFB\u52A0",items:[{type:"INPUT",label:"\u7528\u6237\u540D",labelWidth:"60px",placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u540D",field:"name"},{type:"INPUT",label:"\u8D26\u53F7",labelWidth:"60px",placeholder:"\u8BF7\u8F93\u5165\u8D26\u53F7",field:"username"},{type:"PASSWORD",label:"\u5BC6\u7801",labelWidth:"60px",placeholder:"\u8BF7\u8F93\u5165\u5BC6\u7801",field:"password"},{type:"SELECT",label:"\u89D2\u8272",labelWidth:"60px",placeholder:"\u8BF7\u9009\u62E9\u89D2\u8272",field:"type",options:[{label:"\u89C2\u4F17",value:"0"},{label:"\u8BC4\u59D4",value:"1"},{label:"\u53C2\u8D5B\u9009\u624B",value:"2"}]},{type:"UPLOAD",label:"\u5934\u50CF",labelWidth:"60px",action:"http://175.178.254.201:18720/oss/upload",autoUpload:!0}]},be={class:"race"},fe=d("\u9009\u624B\u5339\u914D"),Ce=d("\u6279\u91CF\u6DFB\u52A0\u89C2\u4F17"),_e=d("\u65B0\u589E"),ve={class:"operation"},Be=d("\u67E5\u770B"),Fe=d("\u4FEE\u6539"),ke=oe({__name:"Race",setup(De){const{race:l}=ue(),C=n({}),m=n(ge);let _=n([]);const k=n([]),V=560,E=n({number:0}),g=n(!1),P=e=>{g.value=e},R=()=>{g.value=!0},U=()=>{const e=te.service({fullscreen:!1});l.batchAdd(E.value.number,g,e)},I=n(),h=n(!1),y=n({name:"",username:"",password:"",type:"",image:""}),M=e=>{h.value=e},O=()=>{h.value=!0},H=e=>{y.value.image=e},L=()=>{l.addUser(y.value,h),y.value={name:"",username:"",password:"",type:"",image:""}},i=S({roll:1}),c=S({roll:1}),$=()=>{i.roll?(l.getRaceTablePageData(1,{roll:c.roll}),v.value=m.value[0].total[i.roll],console.log(v.value)):x("warning","\u672A\u6DFB\u52A0\u67E5\u8BE2\u6761\u4EF6")},q=()=>{i.roll=1,se(()=>{l.getRaceTablePageData(1,{roll:c.roll})})},Q=async()=>{await l.pk(c.roll),x("success","\u8BE5\u8F6E\u4E2D\u9009\u624B\u5339\u914D\u6210\u529F"),l.getRaceTablePageData(1,{roll:c.roll})},v=n(m.value[0].total[i.roll]),K=e=>{k.value=[...e]},Y=async e=>{await l.getRaceTablePageData(e,{roll:c.roll})},j=e=>{l.updateRaceStatus({status:e.status,id:e.id},c.roll)},z=e=>{console.log(e)};return re(async()=>{await l.getRaceTablePageData(1,{roll:1}),_.value=l.pageConfig.records;const{current:e,total:w}=l.pageConfig;C.value={currentPage:e,total:w},l.$subscribe((B,F)=>{_.value=F.pageConfig.records;const{current:b,total:a}=l.pageConfig;C.value={currentPage:b,total:a}}),ne(i,B=>{c.roll=i.roll},{deep:!0});const p=await l.getTotalRoll();m.value[0].total=p}),(e,w)=>{const p=J,B=X,F=Z,b=G;return f(),T("div",be,[r(s(ee),{"bind-data":i,"search-config":m.value,onResetSearch:q,onQuerySearch:$},{extraOperation:t(()=>[v.value?(f(),W(p,{key:0,icon:s(ie),type:"primary",style:{"margin-left":"5px"},onClick:Q},{default:t(()=>[fe]),_:1},8,["icon"])):ce("",!0)]),_:1},8,["bind-data","search-config"]),r(s(ae),{records:s(_),"table-config":s(me),height:V,"is-select":!1,onSelectChange:K},{extraOperation:t(()=>[r(p,{type:"primary",onClick:R},{default:t(()=>[Ce]),_:1}),r(p,{type:"success",onClick:O},{default:t(()=>[_e]),_:1})]),status:t(({scope:a,item:o})=>[r(F,{class:"m-2",modelValue:a.row[o.property],"onUpdate:modelValue":u=>a.row[o.property]=u,placeholder:o.placeholder},{default:t(()=>[(f(!0),T(pe,null,de(o.options,u=>(f(),W(B,{key:u.value,label:u.label,value:u.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder"])]),player1Image:t(({scope:a,item:o})=>[r(b,{style:{width:"48px",height:"48px"},src:a.row[o.property],fit:"cover"},null,8,["src"])]),player2Image:t(({scope:a,item:o})=>[r(b,{style:{width:"48px",height:"48px"},src:a.row[o.property],fit:"cover"},null,8,["src"])]),createTime:t(({scope:a,item:o})=>{var u;return[D("span",null,A((u=a.row[o.property])==null?void 0:u.split(" ")[0]),1)]}),updateTime:t(({scope:a,item:o})=>{var u;return[D("span",null,A((u=a.row[o.property])==null?void 0:u.split(" ")[0]),1)]}),operation:t(({scope:a,item:o})=>[D("div",ve,[r(p,{onClick:u=>z(a)},{default:t(()=>[Be]),_:2},1032,["onClick"]),r(p,{onClick:u=>j(a.row),type:"danger"},{default:t(()=>[Fe]),_:2},1032,["onClick"])])]),_:1},8,["records","table-config"]),r(s(le),{"pagination-config":C.value,onCurrentChange:Y},null,8,["pagination-config"]),r(s(N),{"dialog-config":s(he),"dialog-data":E.value,"dialog-form-visible":g.value,onHide:P,onConfirm:U},null,8,["dialog-config","dialog-data","dialog-form-visible"]),r(s(N),{"dialog-config":s(ye),"dialog-data":y.value,"dialog-form-visible":h.value,onHide:M,onConfirm:L,onChangeImageUrl:H,ref_key:"addDialog",ref:I},null,8,["dialog-config","dialog-data","dialog-form-visible"])])}}});export{ke as default};
