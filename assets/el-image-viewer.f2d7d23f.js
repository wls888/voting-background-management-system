import{ay as he,F as $,L as ce,C as ae,aW as ue,ah as ie,d as de,bB as se,bC as be,bD as ye,P as fe,a2 as _e,r as w,bE as ke,aZ as xe,A as h,l as ne,x as ve,k as pe,o as b,f as oe,m as c,q as z,a as m,Q as u,n as t,ao as Ie,$ as y,am as O,bA as ze,c as S,bg as Le,bh as Ce,U as le,bF as Ee,bG as Oe,h as Se,bH as Te,bI as Ne,bc as $e,w as Ae,a8 as Re,a4 as re,O as G,a9 as Be,aa as Me,N as me,bx as V,J as M,bJ as Ve,a5 as ge,aX as De,Z as Ye,t as Fe,Y as Xe,a0 as He,bK as Pe}from"./index.41b9361d.js";import{d as je,b as we,c as Ze,i as We}from"./el-table-column.5d709dc1.js";var qe="Expected a function";function te(i,d,n){var l=!0,T=!0;if(typeof i!="function")throw new TypeError(qe);return he(n)&&(l="leading"in n?!!n.leading:l,T="trailing"in n?!!n.trailing:T),je(i,d,{leading:l,maxWait:d,trailing:T})}const Ge=(i,d)=>{if(!$||!i||!d)return!1;const n=i.getBoundingClientRect();let l;return d instanceof Element?l=d.getBoundingClientRect():l={top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},n.top<l.bottom&&n.bottom>l.top&&n.right>l.left&&n.left<l.right},Je=()=>$&&/firefox/i.test(window.navigator.userAgent),Ke=ce({urlList:{type:ae(Array),default:()=>ue([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:{type:Boolean,default:!1},teleported:{type:Boolean,default:!1},closeOnPressEscape:{type:Boolean,default:!0}}),Ue={close:()=>!0,switch:i=>ie(i)},Qe=["src"],et={name:"ElImageViewer"},tt=de({...et,props:Ke,emits:Ue,setup(i,{emit:d}){const n=i,l={CONTAIN:{name:"contain",icon:se(be)},ORIGINAL:{name:"original",icon:se(ye)}},T=Je()?"DOMMouseScroll":"mousewheel",{t:L}=we(),r=fe("image-viewer"),{nextZIndex:J}=_e(),N=w(),_=w([]),k=ke(),x=w(!0),f=w(n.initialIndex),p=xe(l.CONTAIN),s=w({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),D=h(()=>{const{urlList:a}=n;return a.length<=1}),A=h(()=>f.value===0),P=h(()=>f.value===n.urlList.length-1),K=h(()=>n.urlList[f.value]),Y=h(()=>{const{scale:a,deg:e,offsetX:o,offsetY:v,enableTransition:C}=s.value;let g=o/a,E=v/a;switch(e%360){case 90:case-270:[g,E]=[E,-g];break;case 180:case-180:[g,E]=[-g,-E];break;case 270:case-90:[g,E]=[-E,g];break}const B={transform:`scale(${a}) rotate(${e}deg) translate(${g}px, ${E}px)`,transition:C?"transform .3s":""};return p.value.name===l.CONTAIN.name&&(B.maxWidth=B.maxHeight="100%"),B}),U=h(()=>ie(n.zIndex)?n.zIndex:J());function R(){Q(),d("close")}function F(){const a=te(o=>{switch(o.code){case M.esc:n.closeOnPressEscape&&R();break;case M.space:H();break;case M.left:W();break;case M.up:I("zoomIn");break;case M.right:q();break;case M.down:I("zoomOut");break}}),e=te(o=>{(o.wheelDelta?o.wheelDelta:-o.detail)>0?I("zoomIn",{zoomRate:1.2,enableTransition:!1}):I("zoomOut",{zoomRate:1.2,enableTransition:!1})});k.run(()=>{V(document,"keydown",a),V(document,T,e)})}function Q(){k.stop()}function ee(){x.value=!1}function j(a){x.value=!1,a.target.alt=L("el.image.error")}function Z(a){if(x.value||a.button!==0||!N.value)return;s.value.enableTransition=!1;const{offsetX:e,offsetY:o}=s.value,v=a.pageX,C=a.pageY,g=te(B=>{s.value={...s.value,offsetX:e+B.pageX-v,offsetY:o+B.pageY-C}}),E=V(document,"mousemove",g);V(document,"mouseup",()=>{E()}),a.preventDefault()}function X(){s.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function H(){if(x.value)return;const a=Ve(l),e=Object.values(l),o=p.value.name,C=(e.findIndex(g=>g.name===o)+1)%a.length;p.value=l[a[C]],X()}function W(){if(A.value&&!n.infinite)return;const a=n.urlList.length;f.value=(f.value-1+a)%a}function q(){if(P.value&&!n.infinite)return;const a=n.urlList.length;f.value=(f.value+1)%a}function I(a,e={}){if(x.value)return;const{zoomRate:o,rotateDeg:v,enableTransition:C}={zoomRate:1.4,rotateDeg:90,enableTransition:!0,...e};switch(a){case"zoomOut":s.value.scale>.2&&(s.value.scale=Number.parseFloat((s.value.scale/o).toFixed(3)));break;case"zoomIn":s.value.scale<7&&(s.value.scale=Number.parseFloat((s.value.scale*o).toFixed(3)));break;case"clockwise":s.value.deg+=v;break;case"anticlockwise":s.value.deg-=v;break}s.value.enableTransition=C}return ne(K,()=>{ve(()=>{const a=_.value[0];a!=null&&a.complete||(x.value=!0)})}),ne(f,a=>{X(),d("switch",a)}),pe(()=>{var a,e;F(),(e=(a=N.value)==null?void 0:a.focus)==null||e.call(a)}),(a,e)=>(b(),oe(Me,{to:"body",disabled:!a.teleported},[c(Be,{name:"viewer-fade",appear:""},{default:z(()=>[m("div",{ref_key:"wrapper",ref:N,tabindex:-1,class:u(t(r).e("wrapper")),style:re({zIndex:t(U)})},[m("div",{class:u(t(r).e("mask")),onClick:e[0]||(e[0]=Ie(o=>a.hideOnClickModal&&R(),["self"]))},null,2),y(" CLOSE "),m("span",{class:u([t(r).e("btn"),t(r).e("close")]),onClick:R},[c(t(O),null,{default:z(()=>[c(t(ze))]),_:1})],2),y(" ARROW "),t(D)?y("v-if",!0):(b(),S(le,{key:0},[m("span",{class:u([t(r).e("btn"),t(r).e("prev"),t(r).is("disabled",!a.infinite&&t(A))]),onClick:W},[c(t(O),null,{default:z(()=>[c(t(Le))]),_:1})],2),m("span",{class:u([t(r).e("btn"),t(r).e("next"),t(r).is("disabled",!a.infinite&&t(P))]),onClick:q},[c(t(O),null,{default:z(()=>[c(t(Ce))]),_:1})],2)],64)),y(" ACTIONS "),m("div",{class:u([t(r).e("btn"),t(r).e("actions")])},[m("div",{class:u(t(r).e("actions__inner"))},[c(t(O),{onClick:e[1]||(e[1]=o=>I("zoomOut"))},{default:z(()=>[c(t(Ee))]),_:1}),c(t(O),{onClick:e[2]||(e[2]=o=>I("zoomIn"))},{default:z(()=>[c(t(Oe))]),_:1}),m("i",{class:u(t(r).e("actions__divider"))},null,2),c(t(O),{onClick:H},{default:z(()=>[(b(),oe(Se(t(p).icon)))]),_:1}),m("i",{class:u(t(r).e("actions__divider"))},null,2),c(t(O),{onClick:e[3]||(e[3]=o=>I("anticlockwise"))},{default:z(()=>[c(t(Te))]),_:1}),c(t(O),{onClick:e[4]||(e[4]=o=>I("clockwise"))},{default:z(()=>[c(t(Ne))]),_:1})],2)],2),y(" CANVAS "),m("div",{class:u(t(r).e("canvas"))},[(b(!0),S(le,null,$e(a.urlList,(o,v)=>Ae((b(),S("img",{ref_for:!0,ref:C=>_.value[v]=C,key:o,src:o,style:re(t(Y)),class:u(t(r).e("img")),onLoad:ee,onError:j,onMousedown:Z},null,46,Qe)),[[Re,v===f.value]])),128))],2),G(a.$slots,"default")],6)]),_:3})],8,["disabled"]))}});var at=me(tt,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image-viewer/src/image-viewer.vue"]]);const nt=ge(at),ot=ce({hideOnClickModal:{type:Boolean,default:!1},src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:{type:Boolean,default:!1},scrollContainer:{type:ae([String,Object])},previewSrcList:{type:ae(Array),default:()=>ue([])},previewTeleported:{type:Boolean,default:!1},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0}}),lt={load:i=>i instanceof Event,error:i=>i instanceof Event,switch:i=>ie(i),close:()=>!0},rt=["src","loading"],it={key:0},st={name:"ElImage",inheritAttrs:!1},ct=de({...st,props:ot,emits:lt,setup(i,{emit:d}){const n=i;let l="";const{t:T}=we(),L=fe("image"),r=De(),J=Ze(),N=w(),_=w(!1),k=w(!0),x=w(!1),f=w(),p=w(),s=$&&"loading"in HTMLImageElement.prototype;let D,A;const P=h(()=>r.style),K=h(()=>{const{fit:e}=n;return $&&e?{objectFit:e}:{}}),Y=h(()=>{const{previewSrcList:e}=n;return Array.isArray(e)&&e.length>0}),U=h(()=>{const{previewSrcList:e,initialIndex:o}=n;let v=o;return o>e.length-1&&(v=0),v}),R=h(()=>n.loading==="eager"?!1:!s&&n.loading==="lazy"||n.lazy),F=()=>{!$||(k.value=!0,_.value=!1,N.value=n.src)};function Q(e){k.value=!1,_.value=!1,d("load",e)}function ee(e){k.value=!1,_.value=!0,d("error",e)}function j(){Ge(f.value,p.value)&&(F(),H())}const Z=Pe(j,200);async function X(){var e;if(!$)return;await ve();const{scrollContainer:o}=n;Xe(o)?p.value=o:He(o)&&o!==""?p.value=(e=document.querySelector(o))!=null?e:void 0:f.value&&(p.value=We(f.value)),p.value&&(D=V(p,"scroll",Z),setTimeout(()=>j(),100))}function H(){!$||!p.value||!Z||(D==null||D(),p.value=void 0)}function W(e){if(!!e.ctrlKey){if(e.deltaY<0)return e.preventDefault(),!1;if(e.deltaY>0)return e.preventDefault(),!1}}function q(){!Y.value||(A=V("wheel",W,{passive:!1}),l=document.body.style.overflow,document.body.style.overflow="hidden",x.value=!0)}function I(){A==null||A(),document.body.style.overflow=l,x.value=!1,d("close")}function a(e){d("switch",e)}return ne(()=>n.src,()=>{R.value?(k.value=!0,_.value=!1,H(),X()):F()}),pe(()=>{R.value?X():F()}),(e,o)=>(b(),S("div",{ref_key:"container",ref:f,class:u([t(L).b(),e.$attrs.class]),style:re(t(P))},[N.value!==void 0&&!_.value?(b(),S("img",Ye({key:0},t(J),{src:N.value,loading:e.loading,style:t(K),class:[t(L).e("inner"),t(Y)&&t(L).e("preview"),k.value&&t(L).is("loading")],onClick:q,onLoad:Q,onError:ee}),null,16,rt)):y("v-if",!0),k.value||_.value?(b(),S("div",{key:1,class:u(t(L).e("wrapper"))},[k.value?G(e.$slots,"placeholder",{key:0},()=>[m("div",{class:u(t(L).e("placeholder"))},null,2)]):_.value?G(e.$slots,"error",{key:1},()=>[m("div",{class:u(t(L).e("error"))},Fe(t(T)("el.image.error")),3)]):y("v-if",!0)],2)):y("v-if",!0),t(Y)?(b(),S(le,{key:2},[x.value?(b(),oe(t(nt),{key:0,"z-index":e.zIndex,"initial-index":t(U),infinite:e.infinite,"url-list":e.previewSrcList,"hide-on-click-modal":e.hideOnClickModal,teleported:e.previewTeleported,"close-on-press-escape":e.closeOnPressEscape,onClose:I,onSwitch:a},{default:z(()=>[e.$slots.viewer?(b(),S("div",it,[G(e.$slots,"viewer")])):y("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","url-list","hide-on-click-modal","teleported","close-on-press-escape"])):y("v-if",!0)],64)):y("v-if",!0)],6))}});var ut=me(ct,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image/src/image.vue"]]);const vt=ge(ut);export{vt as E};
